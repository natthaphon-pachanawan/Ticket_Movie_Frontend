<!-- payment-and-slip.component.html -->
<div class="content-wrapper">
  <div *ngIf="loading" class="p-4">LoadingтАж</div>
  <div *ngIf="!loading" class="p-4 space-y-4">
    <h2 class="text-2xl font-semibold">ЁЯТ│ р╕Кр╕│р╕гр╕░р╣Ар╕Зр╕┤р╕Щ & р╣Бр╕Щр╕Ър╕кр╕ер╕┤р╕Ы</h2>

    <!-- р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Бр╕▓р╕гр╕Ир╕нр╕З -->
    <div class="screening-info">
      <p><strong>р╕лр╕Щр╕▒р╕З:</strong> {{ booking.screening.movie.title }}</p>
      <p><strong>р╣Ар╕зр╕ер╕▓:</strong> {{ booking.screening.screening_datetime | date:'medium' }}</p>
      <p><strong>р╕вр╕нр╕Фр╕Кр╕│р╕гр╕░:</strong> {{ booking.total_price }} р╕Ър╕▓р╕Ч</p>
    </div>

    <!-- QR Code -->
    <div class="qr-zone text-center">
      <img src="http://localhost:8000/storage/payment/qr-code.jpg"
           alt="QR to pay" width="250" class="border mx-auto"/>
      <p class="mt-2 text-sm">
        тЬФя╕П р╕кр╣Бр╕Бр╕Щ QR р╣Бр╕ер╣Йр╕зр╕нр╕▒р╕Ыр╣Вр╕лр╕ер╕Фр╕кр╕ер╕┤р╕Ыр╕ар╕▓р╕вр╣Гр╕Щ <b>{{ remainingTime }}</b><br>
        тЭМ р╕лр╕гр╕╖р╕нр╕Бр╕Ф тАЬр╕вр╕Бр╣Ар╕ер╕┤р╕Бр╕Бр╕▓р╕гр╕Ир╕нр╕ЗтАЭ
      </p>
    </div>

    <!-- р╕кр╕Цр╕▓р╕Щр╕░р╕кр╕ер╕┤р╕Ы -->
    <div *ngIf="slipStatus!=='none'" class="space-y-1 text-center">
      <p>
        р╕кр╕Цр╕▓р╕Щр╕░р╕кр╕ер╕┤р╕Ы:
        <span [ngClass]="{
          'text-yellow-600': slipStatus==='pending',
          'text-green-600' : slipStatus==='confirmed',
          'text-red-600'   : slipStatus==='rejected'
        }">{{ slipStatus }}</span>
      </p>
      <img *ngIf="slipStatus!=='rejected'"
           [src]="'http://localhost:8000/storage/'+slip.slip_image_url"
           width="260" class="border mx-auto"/>
      <p *ngIf="slipStatus==='rejected'" class="text-red-600">
        тЭМ р╕кр╕ер╕┤р╕Ыр╕Цр╕╣р╕Бр╕Ыр╕Пр╕┤р╣Ар╕кр╕Ш р╕Бр╕гр╕╕р╕Ур╕▓р╕нр╕▒р╕Ыр╣Вр╕лр╕ер╕Фр╣Гр╕лр╕бр╣И
      </p>
    </div>

    <!-- р╕Ыр╕╕р╣Ир╕бр╕нр╕▒р╕Ыр╣Вр╕лр╕ер╕Фр╕кр╕ер╕┤р╕Ыр╣Гр╕лр╕бр╣И -->
    <div *ngIf="canUpload()" class="space-y-2 text-center">
      <input type="file"
             accept="image/*"
             (change)="onFileSelected($event)" />
      <div *ngIf="previewUrl" class="text-center">
        <p>р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕З:</p>
        <img [src]="previewUrl" width="260" class="border mx-auto"/>
      </div>
      <button class="px-4 py-2 bg-green-600 text-white rounded"
              (click)="uploadSlip()"
              [disabled]="!selectedFile || uploading">
        тЬЕ {{ slip ? 'р╕нр╕▒р╕Ыр╣Ар╕Фр╕Хр╕кр╕ер╕┤р╕Ыр╣Гр╕лр╕бр╣И' : 'р╕нр╕▒р╕Ыр╣Вр╕лр╕ер╕Фр╕кр╕ер╕┤р╕Ы' }}
      </button>
    </div>

    <!-- р╕Ыр╕╕р╣Ир╕бр╕вр╕Бр╣Ар╕ер╕┤р╕Бр╕Бр╕▓р╕гр╕Ир╕нр╕З -->
    <div class="text-center">
      <button class="px-4 py-2 bg-red-500 text-white rounded"
              (click)="cancelBooking()">
        тЭМ р╕вр╕Бр╣Ар╕ер╕┤р╕Бр╕Бр╕▓р╕гр╕Ир╕нр╕З
      </button>
    </div>
  </div>
</div>
